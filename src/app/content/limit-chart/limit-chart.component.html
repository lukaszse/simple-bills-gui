<div class="row">
  <div class="col-6">
    <div class="card border-secondary mb-3">
      <div class="card-body">
        <!--        start of card body-->
        <h5>Monthly total usage of assigned limit:</h5>
        <div class="col col-form-label" *ngIf="!(categoryUsageLimitService.loadingTotal$ | async) else loading">
          <div *ngIf="categoryUsageLimitService.totalUsageLimitBarchart$ | async as totalBarChart">
            <div *ngIf="totalBarChart.length !==0 else noData">
              <table *ngFor="let chart of totalBarChart">
                <tr>
                  <td>
                    <span>{{chart[0].name}}
                      ({{chart[0].series[0].value | currency}}</span>/{{(chart[0].series[1].value === 0 ? 0 :
                    chart[0].series[0].value + chart[0].series[1].value) | currency}})
                  </td>
                  <td *ngIf="chart[0].series[1].value !== 0 else limitsNotSet">
                    <ngx-charts-bar-horizontal-normalized
                      [view]="view"
                      [results]="chart"
                      [gradient]="gradient"
                      [xAxis]="showXAxis"
                      [yAxis]="showYAxis"
                      [legend]="showLegend"
                      [showXAxisLabel]="showXAxisLabel"
                      [showYAxisLabel]="showYAxisLabel"
                      [xAxisLabel]="xAxisLabel"
                      [yAxisLabel]="yAxisLabel"
                      (select)="onSelect($event)">
                    </ngx-charts-bar-horizontal-normalized>
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>
        <!--        end of card body-->
      </div>
    </div>
  </div>
</div>


<div class="row">
  <div class="col-6">
    <div class="card border-secondary mb-3">
      <div class="card-body">
        <h5>Monthly usage of assigned limits by categories:</h5>
        <!--        start of card body-->
        <div class="col col-form-label " *ngIf="!(categoryUsageLimitService.loadingCategories$ | async) else loading">
          <div *ngIf="categoryUsageLimitService.categoryUsageBarChart$ | async as barCharts">
            <div *ngIf="barCharts.length !==0 else noData">
              <table>
                <tr *ngFor="let chart of barCharts">
                  <td>
                    <span>{{chart[0].name}}
                      ({{chart[0].series[0].value | currency}}</span>/{{(chart[0].series[1].value === 0 ? 0 :
                    chart[0].series[0].value + chart[0].series[1].value) | currency}})
                  </td>
                  <div class="text-center">
                    <td *ngIf="chart[0].series[1].value !== 0 else limitsNotSet">
                      <ngx-charts-bar-horizontal-normalized
                        [view]="view"
                        [results]="chart"
                        [gradient]="gradient"
                        [xAxis]="showXAxis"
                        [yAxis]="showYAxis"
                        [legend]="showLegend"
                        [showXAxisLabel]="showXAxisLabel"
                        [showYAxisLabel]="showYAxisLabel"
                        [xAxisLabel]="xAxisLabel"
                        [yAxisLabel]="yAxisLabel"
                        (select)="onSelect($event)">
                      </ngx-charts-bar-horizontal-normalized>
                    </td>
                  </div>
                </tr>
              </table>
            </div>
          </div>
        </div>
        <!--        end of card body-->
      </div>
    </div>
  </div>
</div>

<ng-template #loading>
  <span class="text-dark">loading... </span>
</ng-template>

<ng-template #noData>
  <br>
  <h6 class="text-info text-center fw-bold">Add any category with assigned limit to see chart here</h6>
</ng-template>

<ng-template #limitsNotSet>
  <span class="text-info fst-italic">Limit for category not set!</span>
</ng-template>

